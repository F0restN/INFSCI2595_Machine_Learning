"0","post_lm_pred_samples <- function(Xnew, Bmat, sigma_vector)"
"0","{"
"0","  # number of new prediction locations"
"0","  M <- nrow(Xnew)"
"0","  # number of posterior samples"
"0","  S <- nrow(Bmat)"
"0","  "
"0","  # matrix of linear predictors"
"0","  Umat <- Xnew %*% t(Bmat)"
"0","  "
"0","  # assmeble matrix of sigma samples, set the number of rows"
"0","  Rmat <- matrix(rep(sigma_vector, M), nrow = M, byrow = TRUE)"
"0","  "
"0","  # generate standard normal and assemble into matrix"
"0","  # set the number of rows"
"0","  Zmat <- matrix(rnorm(M*S), nrow = M, byrow = TRUE)"
"0","  "
"0","  # calculate the random observation predictions"
"0","  Ymat <- Umat + Zmat * Rmat"
"0","  "
"0","  # package together"
"0","  list(Umat = Umat, Ymat = Ymat)"
"0","}"
